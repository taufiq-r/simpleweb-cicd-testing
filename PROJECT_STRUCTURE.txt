Full-Stack Application with CI/CD Infrastructure
================================================

testing/
â”‚
â”œâ”€â”€ .github/                                    # GitHub Actions configuration
â”‚   â”œâ”€â”€ actions/
â”‚   â”‚   â””â”€â”€ discord-notify/
â”‚   â”‚       â””â”€â”€ action.yml                     # Reusable Discord webhook action
â”‚   â”‚
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml                             # Build & push images (all branches)
â”‚       â”œâ”€â”€ deploy-staging.yml                 # Deploy to staging (develop branch)
â”‚       â”œâ”€â”€ deploy-production.yml              # Deploy to production (main branch)
â”‚       â”œâ”€â”€ notify-issue.yml                   # Notify Discord on new issues
â”‚       â”œâ”€â”€ notify-pr.yml                      # Notify Discord on new PRs
â”‚       â””â”€â”€ lint-test.yml                      # Optional: linting and testing
â”‚
â”œâ”€â”€ frontend/                                   # React + Vite + TypeScript
â”‚   â”œâ”€â”€ Dockerfile                             # Multi-stage build: Node â†’ Nginx
â”‚   â”œâ”€â”€ package.json                           # Dependencies: React, Zustand, TanStack, etc.
â”‚   â”œâ”€â”€ vite.config.ts                         # Vite configuration
â”‚   â”œâ”€â”€ index.html                             # HTML entry point
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ main.tsx                           # React entry
â”‚       â””â”€â”€ App.tsx                            # Root component
â”‚
â”œâ”€â”€ backend/                                    # Bun + Hono + TypeScript
â”‚   â”œâ”€â”€ Dockerfile                             # Bun runtime image
â”‚   â”œâ”€â”€ package.json                           # Dependencies: Hono, Zod, etc.
â”‚   â””â”€â”€ src/
â”‚       â””â”€â”€ index.ts                           # Hono app with routes
â”‚
â”œâ”€â”€ docker-compose.yml                         # Local dev: postgres, pgbouncer, services
â”‚
â”œâ”€â”€ pgbouncer/                                  # PostgreSQL connection pooling
â”‚   â”œâ”€â”€ pgbouncer.ini                          # Pool configuration
â”‚   â”œâ”€â”€ userlist.txt                           # User credentials (MD5 hashed)
â”‚   â””â”€â”€ gen-hash.sh                            # Script to generate MD5 password hash
â”‚
â”œâ”€â”€ nginx/                                      # Reverse proxy
â”‚   â””â”€â”€ nginx.conf                             # Routes /api/* to backend, / to frontend
â”‚
â”œâ”€â”€ nomad/                                      # HashiCorp Nomad job definitions
â”‚   â”œâ”€â”€ postgres.nomad                         # PostgreSQL 17 job
â”‚   â”œâ”€â”€ pgbouncer.nomad                        # PGBouncer job (service discovery)
â”‚   â”œâ”€â”€ backend.nomad                          # Backend API job
â”‚   â”œâ”€â”€ frontend.nomad                         # Frontend SPA job
â”‚   â””â”€â”€ nginx.nomad                            # Nginx reverse proxy job
â”‚
â”œâ”€â”€ stack/                                      # Docker Swarm stack definitions
â”‚   â””â”€â”€ docker-stack.yml                       # Services for Docker Swarm deployment
â”‚
â”œâ”€â”€ scripts/                                    # Deployment and setup scripts
â”‚   â”œâ”€â”€ deploy.sh                              # Main deployment script (SSH-executed)
â”‚   â”œâ”€â”€ setup-server.sh                        # Initialize staging/prod server
â”‚   â”œâ”€â”€ gen-pgbouncer-pwd.sh                   # Generate pgbouncer password hash
â”‚   â””â”€â”€ validate.sh                            # Local validation checks
â”‚
â”œâ”€â”€ docs/                                       # Comprehensive documentation
â”‚   â”œâ”€â”€ GITHUB_ACTIONS.md                      # Secrets setup, workflow details
â”‚   â”œâ”€â”€ DEPLOYMENT.md                          # Server setup, manual deployment
â”‚   â””â”€â”€ ARCHITECTURE.md                        # System design, scaling, security
â”‚
â”œâ”€â”€ README.md                                   # Main project documentation
â”œâ”€â”€ QUICKSTART.md                              # Quick start guide (5-min setup)
â”œâ”€â”€ .env.example                               # Environment variables template
â”œâ”€â”€ .gitignore                                  # Git ignore patterns
â””â”€â”€ PROJECT_STRUCTURE.txt                      # This file

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TECH STACK SUMMARY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Frontend:
  â€¢ React 18.2 (UI framework)
  â€¢ Vite (fast build tool)
  â€¢ TypeScript (type safety)
  â€¢ Zustand (state management)
  â€¢ TanStack Query (data fetching)
  â€¢ TanStack Router (file-based routing)
  â€¢ shadcn UI + Tailwind CSS 4 (components & styles)
  â€¢ Tabler/Iconly (icons)
  â€¢ Zod (schema validation)

Backend:
  â€¢ Bun (runtime)
  â€¢ Hono (HTTP framework)
  â€¢ TypeScript (type safety)
  â€¢ Zod (schema validation)
  â€¢ Drizzle ORM (ready to implement)
  â€¢ Scalar (OpenAPI docs - ready to implement)

Database:
  â€¢ PostgreSQL 17 (primary DB)
  â€¢ PGBouncer (connection pooling)
  â€¢ Support for multi-tenant schemas

Infrastructure:
  â€¢ Docker & Docker Compose (containerization)
  â€¢ Nginx (reverse proxy, load balancer)
  â€¢ Docker Swarm (orchestration option 1)
  â€¢ Nomad (orchestration option 2)
  â€¢ GitHub Actions (CI/CD)
  â€¢ GHCR (container registry)

Optional:
  â€¢ Wasabi S3 (object storage via Bun SDK)
  â€¢ Discord webhooks (notifications)
  â€¢ JWT/Auth middleware (implement in Hono)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CI/CD WORKFLOW SUMMARY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. ci.yml (all pushes/PRs)
   â”œâ”€ Build frontend image
   â”œâ”€ Build backend image
   â”œâ”€ Push to GHCR
   â””â”€ Notify Discord (âœ… success or âŒ failure with logs)

2. deploy-staging.yml (develop branch)
   â”œâ”€ Build & push images
   â”œâ”€ SSH deploy to staging server
   â”œâ”€ Pull & restart services
   â””â”€ Notify Discord with staging URL

3. deploy-production.yml (main branch)
   â”œâ”€ Build & push images
   â”œâ”€ SSH deploy to production server
   â”œâ”€ Pull & restart services
   â””â”€ Notify Discord with production URL

4. notify-issue.yml (new issue opened)
   â”œâ”€ Send Discord webhook
   â””â”€ Post bot comment on issue

5. notify-pr.yml (PR opened/reopened)
   â””â”€ Send Discord webhook

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

QUICK COMMANDS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Local Development:
  docker-compose up --build          # Start all services locally
  docker-compose down                # Stop all services
  docker-compose logs -f             # View logs

Docker Swarm (on server):
  docker swarm init                  # Initialize swarm (one-time)
  docker stack deploy -c docker-stack.yml app_prod
  docker service ls                  # List services
  docker service logs app_prod_backend  # View service logs
  docker stack rm app_prod           # Remove stack

Nomad (on server):
  nomad job run nomad/backend.nomad  # Deploy job
  nomad status backend               # Check job status
  nomad logs -f backend -task api    # View logs
  nomad job stop backend             # Stop job

Deployment Scripts:
  bash scripts/validate.sh           # Validate local setup
  bash scripts/setup-server.sh       # Setup new server
  bash scripts/deploy.sh             # Deploy script (used by CI/CD)

Database:
  psql -h localhost -p 5432 -U app -d appdb  # Connect locally
  psql -h pgbouncer -p 6432 -U app -d appdb  # Via pgbouncer
  bash pgbouncer/gen-hash.sh changeme        # Generate password hash

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GITHUB SECRETS TO CONFIGURE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Essential (for CI/CD):
  DISCORD_WEBHOOK       â†’ Discord webhook URL
  STAGE_HOST           â†’ Staging server IP/domain
  PROD_HOST            â†’ Production server IP/domain
  DEPLOY_USER          â†’ SSH user (default: deploy)
  SSH_PRIVATE_KEY      â†’ Private SSH key (4096-bit RSA)
  STAGE_APP_URL        â†’ https://staging.example.com
  PROD_APP_URL         â†’ https://example.com

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DEPLOYMENT FLOW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Developer commits code
         â†“
Push to develop branch
         â†“
[CI Workflow Runs]
  â€¢ Build frontend & backend
  â€¢ Push to GHCR
  â€¢ Notify Discord
         â†“
[Deploy Staging Workflow Runs]
  â€¢ SSH to staging server
  â€¢ Pull latest images
  â€¢ Deploy stack (Docker Swarm or Nomad)
  â€¢ Notify Discord with URL
         â†“
Developer tests on staging
         â†“
Create PR â†’ Merge to main
         â†“
[Deploy Production Workflow Runs]
  â€¢ SSH to production server
  â€¢ Pull latest images
  â€¢ Deploy stack
  â€¢ Notify Discord with prod URL
         â†“
Live in production! ğŸš€

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DOCUMENTATION GUIDE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Start here:
  1. QUICKSTART.md          â† 5-minute setup overview
  2. README.md              â† Detailed project description

Then read:
  3. docs/GITHUB_ACTIONS.md â† How to configure secrets & workflows
  4. docs/DEPLOYMENT.md     â† How to set up servers & manual deploy
  5. docs/ARCHITECTURE.md   â† System design, scaling, security

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SUPPORT & NEXT STEPS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Initialize git repository
   git init && git add . && git commit -m "Initial scaffold"

2. Create GitHub repository and push
   git remote add origin <repo-url>
   git push -u origin main

3. Configure GitHub secrets (5 minutes)
   See: docs/GITHUB_ACTIONS.md â†’ Step 1

4. Test CI/CD locally
   docker-compose up --build

5. Deploy
   Push to develop â†’ stage
   Merge to main â†’ production

Questions? Check:
  â€¢ docs/ folder for detailed guides
  â€¢ GitHub Actions logs for workflow errors
  â€¢ Discord notifications for deployment status

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
